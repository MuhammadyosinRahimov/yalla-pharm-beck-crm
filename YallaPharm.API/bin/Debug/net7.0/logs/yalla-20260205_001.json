{"@t":"2026-02-05T11:04:53.1196631Z","@mt":"Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.","@l":"Warning","EventId":{"Id":10400,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.SensitiveDataLoggingEnabledWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
{"@t":"2026-02-05T11:04:55.0061140Z","@mt":"Checking database schema...","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:04:55.4937252Z","@mt":"Database schema check completed","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:04:56.7253988Z","@mt":"Default admin user already exists","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:04:56.7281506Z","@mt":"Database seeding completed successfully","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:04:56.7314593Z","@mt":"Database seeding completed successfully"}
{"@t":"2026-02-05T11:04:57.0045053Z","@mt":"Yalla Pharm CRM API starting on {Urls}","Urls":""}
{"@t":"2026-02-05T11:04:57.2127607Z","@mt":"Application terminated unexpectedly","@l":"Fatal","@x":"System.IO.IOException: Failed to bind to address http://127.0.0.1:5071: address already in use.\r\n ---> Microsoft.AspNetCore.Connections.AddressInUseException: Обычно разрешается только одно использование адреса сокета (протокол/сетевой адрес/порт).\r\n ---> System.Net.Sockets.SocketException (10048): Обычно разрешается только одно использование адреса сокета (протокол/сетевой адрес/порт).\r\n   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)\r\n   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)\r\n   at System.Net.Sockets.Socket.Bind(EndPoint localEP)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()\r\n   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass30_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IEnumerable`1 listenOptions, AddressBindContext context, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)\r\n   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)\r\n   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)\r\n   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)\r\n   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)\r\n   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)\r\n   at Program.<Main>$(String[] args) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Program.cs:line 261"}
{"@t":"2026-02-05T11:06:45.9991139Z","@mt":"Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.","@l":"Warning","EventId":{"Id":10400,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.SensitiveDataLoggingEnabledWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
{"@t":"2026-02-05T11:06:48.1396312Z","@mt":"Checking database schema...","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:06:48.6185096Z","@mt":"Database schema check completed","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:06:50.0266963Z","@mt":"Default admin user already exists","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:06:50.0271569Z","@mt":"Database seeding completed successfully","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:06:50.0284824Z","@mt":"Database seeding completed successfully"}
{"@t":"2026-02-05T11:06:50.5170471Z","@mt":"Yalla Pharm CRM API starting on {Urls}","Urls":""}
{"@t":"2026-02-05T11:08:04.9058275Z","@mt":"User {Email} logged in successfully","Email":"admin@yallapharm.com","SourceContext":"YallaPharm.Application.Services.AuthService","ActionId":"fd3d1dfa-1df0-4e83-aba4-b78160de3473","ActionName":"YallaPharm.API.Controllers.LoginController.Login (YallaPharm.API)","RequestId":"0HNJ4KRA9S4EB:00000001","RequestPath":"/api/login","ConnectionId":"0HNJ4KRA9S4EB"}
{"@t":"2026-02-05T11:08:05.0876279Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["1777.7140"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":200,"Elapsed":1777.714,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KRA9S4EB:00000001","ConnectionId":"0HNJ4KRA9S4EB"}
{"@t":"2026-02-05T11:09:20.3384669Z","@mt":"Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.","@l":"Warning","EventId":{"Id":10400,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.SensitiveDataLoggingEnabledWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
{"@t":"2026-02-05T11:09:21.6392961Z","@mt":"Checking database schema...","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:09:21.9239464Z","@mt":"Database schema check completed","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:09:22.6070166Z","@mt":"Default admin user already exists","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:09:22.6072008Z","@mt":"Database seeding completed successfully","SourceContext":"YallaPharm.Infrastructure.Data.DbSeeder"}
{"@t":"2026-02-05T11:09:22.6078623Z","@mt":"Database seeding completed successfully"}
{"@t":"2026-02-05T11:09:22.8071965Z","@mt":"Yalla Pharm CRM API starting on {Urls}","Urls":""}
{"@t":"2026-02-05T11:09:40.3330295Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["264.7002"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":400,"Elapsed":264.7002,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN0:00000001","ConnectionId":"0HNJ4KS78KGN0"}
{"@t":"2026-02-05T11:12:06.4250387Z","@mt":"User {Email} logged in successfully","Email":"admin@yallapharm.com","SourceContext":"YallaPharm.Application.Services.AuthService","ActionId":"3bbf6e63-6d28-4f2e-b684-9d6133b6e26d","ActionName":"YallaPharm.API.Controllers.LoginController.Login (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000001","RequestPath":"/api/login","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:06.4523300Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["574.8114"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":200,"Elapsed":574.8114,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000001","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:06.8657071Z","@mt":"User {Email} logged in successfully","Email":"admin@yallapharm.com","SourceContext":"YallaPharm.Application.Services.AuthService","ActionId":"3bbf6e63-6d28-4f2e-b684-9d6133b6e26d","ActionName":"YallaPharm.API.Controllers.LoginController.Login (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000002","RequestPath":"/api/login","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:06.8671218Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["301.3185"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":200,"Elapsed":301.3185,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000002","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.0142454Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["72.6978"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/user","StatusCode":200,"Elapsed":72.6978,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000003","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.1413445Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["72.2514"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/user/test-user-id","StatusCode":404,"Elapsed":72.2514,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000004","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.2587687Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["54.9278"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/user/update","StatusCode":404,"Elapsed":54.9278,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000005","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.8153243Z","@mt":"Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.","@l":"Warning","EventId":{"Id":20504,"Name":"Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"c46cceb4-b06e-40aa-ad8a-2cb3f37a4b0e","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000006","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.8858494Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"34","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, a.id, a.city, a.client_id, a.geolocation_of_client_address, a.landmark, a.street, c0.id, c0.age, c0.client_id, c0.full_name, c0.gender, c1.id, c1.age, c1.client_id, c1.full_name, c1.gender\r\nFROM clients AS c\r\nLEFT JOIN addresses AS a ON c.id = a.client_id\r\nLEFT JOIN client_childrens AS c0 ON c.id = c0.client_id\r\nLEFT JOIN client_adults AS c1 ON c.id = c1.client_id\r\nORDER BY c.id, a.id, c0.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c46cceb4-b06e-40aa-ad8a-2cb3f37a4b0e","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000006","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.9353966Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"c46cceb4-b06e-40aa-ad8a-2cb3f37a4b0e","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000006","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.9468940Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["618.7950"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 205\r\n   at YallaPharm.API.Controllers.ClientApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/clients","StatusCode":500,"Elapsed":618.795,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000006","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:07.9806895Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 205\r\n   at YallaPharm.API.Controllers.ClientApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/clients","TraceId":"0HNJ4KS78KGN1:00000006","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000006","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.2270780Z","@mt":"Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.","@l":"Warning","EventId":{"Id":20504,"Name":"Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"480e8c2d-c5a9-472f-979a-82f3dbdeed6f","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000007","RequestPath":"/api/clients/test-client-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.2601708Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__id_0='test-client-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.age, t.childrens_age, t.contact_type, t.discount_for_client, t.economic_standing, t.family_status, t.full_name, t.gender, t.geolocation_of_client_address, t.having_children, t.having_elderly, t.landmark, t.language, t.phone_number, t.social_username, t.street, t.take_into_account, t.type, a.id, a.city, a.client_id, a.geolocation_of_client_address, a.landmark, a.street, c0.id, c0.age, c0.client_id, c0.full_name, c0.gender, c1.id, c1.age, c1.client_id, c1.full_name, c1.gender\r\nFROM (\r\n    SELECT c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type\r\n    FROM clients AS c\r\n    WHERE c.id = @__id_0\r\n    LIMIT 1\r\n) AS t\r\nLEFT JOIN addresses AS a ON t.id = a.client_id\r\nLEFT JOIN client_childrens AS c0 ON t.id = c0.client_id\r\nLEFT JOIN client_adults AS c1 ON t.id = c1.client_id\r\nORDER BY t.id, a.id, c0.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"480e8c2d-c5a9-472f-979a-82f3dbdeed6f","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000007","RequestPath":"/api/clients/test-client-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.2652262Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"480e8c2d-c5a9-472f-979a-82f3dbdeed6f","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000007","RequestPath":"/api/clients/test-client-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.2755605Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["124.8120"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 194\r\n   at YallaPharm.API.Controllers.ClientApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 51\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/clients/test-client-id","StatusCode":500,"Elapsed":124.812,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000007","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.3005162Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 194\r\n   at YallaPharm.API.Controllers.ClientApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 51\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/clients/test-client-id","TraceId":"0HNJ4KS78KGN1:00000007","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000007","RequestPath":"/api/clients/test-client-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.4870576Z","@mt":"Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.","@l":"Warning","EventId":{"Id":20504,"Name":"Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"90f6db5b-9ef2-4108-ba76-3417a24b7fb7","ActionName":"YallaPharm.API.Controllers.ClientApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000008","RequestPath":"/api/clients/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.5035959Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_Id_0='test-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.age, t.childrens_age, t.contact_type, t.discount_for_client, t.economic_standing, t.family_status, t.full_name, t.gender, t.geolocation_of_client_address, t.having_children, t.having_elderly, t.landmark, t.language, t.phone_number, t.social_username, t.street, t.take_into_account, t.type, a.id, a.city, a.client_id, a.geolocation_of_client_address, a.landmark, a.street, c0.id, c0.age, c0.client_id, c0.full_name, c0.gender, c1.id, c1.age, c1.client_id, c1.full_name, c1.gender\r\nFROM (\r\n    SELECT c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type\r\n    FROM clients AS c\r\n    WHERE c.id = @__dto_Id_0\r\n    LIMIT 1\r\n) AS t\r\nLEFT JOIN addresses AS a ON t.id = a.client_id\r\nLEFT JOIN client_childrens AS c0 ON t.id = c0.client_id\r\nLEFT JOIN client_adults AS c1 ON t.id = c1.client_id\r\nORDER BY t.id, a.id, c0.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"90f6db5b-9ef2-4108-ba76-3417a24b7fb7","ActionName":"YallaPharm.API.Controllers.ClientApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000008","RequestPath":"/api/clients/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.5069342Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"90f6db5b-9ef2-4108-ba76-3417a24b7fb7","ActionName":"YallaPharm.API.Controllers.ClientApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000008","RequestPath":"/api/clients/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.5131115Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["126.4013"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.UpdateAsync(ClientDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 97\r\n   at YallaPharm.API.Controllers.ClientApiController.Update(ClientDto clientDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 32\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/clients/update","StatusCode":500,"Elapsed":126.4013,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000008","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.5226630Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 913\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.UpdateAsync(ClientDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 97\r\n   at YallaPharm.API.Controllers.ClientApiController.Update(ClientDto clientDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 32\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 913\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/clients/update","TraceId":"0HNJ4KS78KGN1:00000008","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000008","RequestPath":"/api/clients/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:08.9158870Z","@mt":"Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.","@l":"Warning","EventId":{"Id":20504,"Name":"Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000009","RequestPath":"/api/orders/by-state/1/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.0101564Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"25","parameters":"@__state_0='Application' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000009","RequestPath":"/api/orders/by-state/1/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.0140923Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000009","RequestPath":"/api/orders/by-state/1/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.0205706Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["421.8983"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/1/10","StatusCode":500,"Elapsed":421.8983,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000009","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.0317480Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/1/10","TraceId":"0HNJ4KS78KGN1:00000009","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000009","RequestPath":"/api/orders/by-state/1/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.1165981Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"4","parameters":"@__state_0='InSearch' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000A","RequestPath":"/api/orders/by-state/2/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.1228992Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000A","RequestPath":"/api/orders/by-state/2/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.1340319Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27.1129"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/2/10","StatusCode":500,"Elapsed":27.1129,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000A","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.1485357Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/2/10","TraceId":"0HNJ4KS78KGN1:0000000A","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000A","RequestPath":"/api/orders/by-state/2/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.2318726Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"4","parameters":"@__state_0='WaitingClient' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000B","RequestPath":"/api/orders/by-state/3/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.2359681Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000B","RequestPath":"/api/orders/by-state/3/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.2430900Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["21.3002"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/3/10","StatusCode":500,"Elapsed":21.3002,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000B","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.2649722Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/3/10","TraceId":"0HNJ4KS78KGN1:0000000B","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000B","RequestPath":"/api/orders/by-state/3/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.3523526Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"4","parameters":"@__state_0='Placement' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000C","RequestPath":"/api/orders/by-state/4/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.3589040Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000C","RequestPath":"/api/orders/by-state/4/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.3707298Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["30.9380"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/4/10","StatusCode":500,"Elapsed":30.938,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000C","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.3829538Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/4/10","TraceId":"0HNJ4KS78KGN1:0000000C","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000C","RequestPath":"/api/orders/by-state/4/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.4737305Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"5","parameters":"@__state_0='Placed' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000D","RequestPath":"/api/orders/by-state/5/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.4793583Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000D","RequestPath":"/api/orders/by-state/5/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.4898036Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["24.8055"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/5/10","StatusCode":500,"Elapsed":24.8055,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000D","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.5055398Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/5/10","TraceId":"0HNJ4KS78KGN1:0000000D","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000D","RequestPath":"/api/orders/by-state/5/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.7611615Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"11","parameters":"@__state_0='ReadyForShipment' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000E","RequestPath":"/api/orders/by-state/6/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.8146149Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"b9603b99-0b19-4927-bbf1-e9a391b5ec1c","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000E","RequestPath":"/api/orders/by-state/6/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.8267059Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["85.8675"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/by-state/6/10","StatusCode":500,"Elapsed":85.8675,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000E","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:09.8898949Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByState(OrderState orderState, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 53\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/by-state/6/10","TraceId":"0HNJ4KS78KGN1:0000000E","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000E","RequestPath":"/api/orders/by-state/6/10","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.1078444Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"@__state_0='Application' (Nullable = false), @__p_1='10'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, t.id0, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id AS id0, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection, CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END AS c\r\n    FROM orders AS o\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE (o0.id IS NOT NULL) AND o0.state = @__state_0\r\n    ORDER BY CASE\r\n        WHEN o0.id IS NOT NULL THEN o0.created_at\r\n        ELSE TIMESTAMPTZ '-infinity'\r\n    END DESC\r\n    LIMIT @__p_1\r\n) AS t\r\nINNER JOIN clients AS c ON t.client_id = c.id\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.c DESC, t.id, t.id0, c.id, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"7bc0f870-212b-423a-9af3-1fc3b9e9e4a7","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByStateFilter (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000F","RequestPath":"/api/orders/by-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.1127525Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"7bc0f870-212b-423a-9af3-1fc3b9e9e4a7","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetByStateFilter (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000000F","RequestPath":"/api/orders/by-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.1217928Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["52.1587"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.Application.Services.OrderService.GetByStateFilterAsync(OrdersByStateFilterDto filter) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 267\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByStateFilter(OrdersByStateFilterDto filter) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 60\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/by-state","StatusCode":500,"Elapsed":52.1587,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000000F","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.1336967Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3394\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByStateAsync(OrderState state, Int32 count, String orderOrClientInfo) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 254\r\n   at YallaPharm.Application.Services.OrderService.GetByStateFilterAsync(OrdersByStateFilterDto filter) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 267\r\n   at YallaPharm.API.Controllers.OrderApiController.GetByStateFilter(OrdersByStateFilterDto filter) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 60\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3394\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/by-state","TraceId":"0HNJ4KS78KGN1:0000000F","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000000F","RequestPath":"/api/orders/by-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.3548542Z","@mt":"Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.","@l":"Warning","EventId":{"Id":20504,"Name":"Microsoft.EntityFrameworkCore.Query.MultipleCollectionIncludeWarning"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"7a3ed0ab-f1d7-4fe8-9aff-57c27b592154","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000010","RequestPath":"/api/orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.4080263Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"@__orderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.amount_with_delivery, t.amount_with_discount, t.amount_with_markup, t.amount_without_delivery, t.amount_without_markup, t.city_or_district, t.client_id, t.comes_from, t.comment, t.comment_for_courier, t.country_to_delivery, t.courier, t.delivered_at, t.delivery_type, t.discount, t.operator, t.order_number, t.prepayment, t.price_for_delivery_outside_the_city, t.remaining_payment, t.rest_payment, t.total_cost, t.total_order_amount_excluding_delivery, t.type, t.id0, t.age, t.childrens_age, t.contact_type, t.discount_for_client, t.economic_standing, t.family_status, t.full_name, t.gender, t.geolocation_of_client_address, t.having_children, t.having_elderly, t.landmark, t.language, t.phone_number, t.social_username, t.street, t.take_into_account, t.type0, t.id1, t.amount_of_delivery_time, t.amount_of_processing_time, t.amount_of_time_respond_client, t.calling_at, t.canceled_at, t.comment_for_courier0, t.confirmed_at, t.consulted_at, t.courier_accepted_at, t.courier_received_at, t.created_at, t.delivered_at0, t.delivered_time, t.individual_delivery_time, t.is_returned, t.lead_created_at, t.long_search_reason, t.message, t.minutes_for_entire_process_finish, t.minutes_for_entire_process_to_placement, t.notified_at, t.order_date, t.order_id, t.order_processing_time, t.past_state, t.payment_method, t.payment_status, t.placed_at, t.placement_at, t.previous_state_before_rejection_state, t.ready_for_shipment_at, t.reason_for_order_cancellation, t.reason_for_order_delay, t.reason_for_order_rejection, t.reason_for_returning_the_order, t.request_date, t.request_processing_time, t.returned_products_count, t.searching_at, t.state, t.time_for_accepting_request, t.time_inform_customer_about_product, t.time_of_completion_of_inquiry, t.time_to_obtain_client_approval, t.time_to_send_check_to_client, t.was_rejection, t0.id, t0.order_id, t0.pharmacy_id, t0.id0, t0.address, t0.contact, t0.country, t0.geolocation_link, t0.is_abroad, t0.is_required, t0.landmark, t0.markup, t0.markup_type, t0.name, t0.payout_method, t0.id1, t0.amount_with_markup, t0.amount_without_markup, t0.arrival_date, t0.comment, t0.count, t0.created_at, t0.is_returned, t0.long_search_reason, t0.message, t0.pharmacy_order_id, t0.product_id, t0.return_reason, t0.return_to, t0.returned_count, t0.id00, t0.age_from, t0.age_to, t0.age_type, t0.count_on_package, t0.country0, t0.dificit, t0.dosage, t0.is_required0, t0.link_product, t0.manufacturer, t0.name0, t0.packaging_unit, t0.path_image, t0.price_with_markup, t0.price_without_markup, t0.release_form, t0.state, t0.type, t0.type_of_packaging\r\nFROM (\r\n    SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, c.id AS id0, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type AS type0, o0.id AS id1, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier AS comment_for_courier0, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at AS delivered_at0, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\n    FROM orders AS o\r\n    INNER JOIN clients AS c ON o.client_id = c.id\r\n    LEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\n    WHERE o.id = @__orderId_0\r\n    LIMIT 1\r\n) AS t\r\nLEFT JOIN (\r\n    SELECT p.id, p.order_id, p.pharmacy_id, p0.id AS id0, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t1.id AS id1, t1.amount_with_markup, t1.amount_without_markup, t1.arrival_date, t1.comment, t1.count, t1.created_at, t1.is_returned, t1.long_search_reason, t1.message, t1.pharmacy_order_id, t1.product_id, t1.return_reason, t1.return_to, t1.returned_count, t1.id0 AS id00, t1.age_from, t1.age_to, t1.age_type, t1.count_on_package, t1.country AS country0, t1.dificit, t1.dosage, t1.is_required AS is_required0, t1.link_product, t1.manufacturer, t1.name AS name0, t1.packaging_unit, t1.path_image, t1.price_with_markup, t1.price_without_markup, t1.release_form, t1.state, t1.type, t1.type_of_packaging\r\n    FROM pharmacy_orders AS p\r\n    LEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\n    LEFT JOIN (\r\n        SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n        FROM product_histories AS p1\r\n        LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n    ) AS t1 ON p.id = t1.pharmacy_order_id\r\n) AS t0 ON t.id = t0.order_id\r\nORDER BY t.id, t.id0, t.id1, t0.id, t0.id0, t0.id1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"7a3ed0ab-f1d7-4fe8-9aff-57c27b592154","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000010","RequestPath":"/api/orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.4121684Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3710\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3710\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3710\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3710\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"7a3ed0ab-f1d7-4fe8-9aff-57c27b592154","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000010","RequestPath":"/api/orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.4222312Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["224.2802"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3710\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByIdAsync(String orderId, Nullable`1 orderState) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 292\r\n   at YallaPharm.API.Controllers.OrderApiController.GetById(String orderId, Nullable`1 orderState) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 67\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3710\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/test-order-id","StatusCode":500,"Elapsed":224.2802,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000010","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.4346485Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 3710\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetByIdAsync(String orderId, Nullable`1 orderState) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 292\r\n   at YallaPharm.API.Controllers.OrderApiController.GetById(String orderId, Nullable`1 orderState) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 67\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 3710\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/test-order-id","TraceId":"0HNJ4KS78KGN1:00000010","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000010","RequestPath":"/api/orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.6021607Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["84.2053"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/order-number/test-order-id","StatusCode":404,"Elapsed":84.2053,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000011","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.7349470Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"@__orderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.order_id, p.pharmacy_id, p0.id, p0.address, p0.contact, p0.country, p0.geolocation_link, p0.is_abroad, p0.is_required, p0.landmark, p0.markup, p0.markup_type, p0.name, p0.payout_method, t.id, t.amount_with_markup, t.amount_without_markup, t.arrival_date, t.comment, t.count, t.created_at, t.is_returned, t.long_search_reason, t.message, t.pharmacy_order_id, t.product_id, t.return_reason, t.return_to, t.returned_count, t.id0, t.age_from, t.age_to, t.age_type, t.count_on_package, t.country, t.dificit, t.dosage, t.is_required, t.link_product, t.manufacturer, t.name, t.packaging_unit, t.path_image, t.price_with_markup, t.price_without_markup, t.release_form, t.state, t.type, t.type_of_packaging\r\nFROM pharmacy_orders AS p\r\nLEFT JOIN pharmacies AS p0 ON p.pharmacy_id = p0.id\r\nLEFT JOIN (\r\n    SELECT p1.id, p1.amount_with_markup, p1.amount_without_markup, p1.arrival_date, p1.comment, p1.count, p1.created_at, p1.is_returned, p1.long_search_reason, p1.message, p1.pharmacy_order_id, p1.product_id, p1.return_reason, p1.return_to, p1.returned_count, p2.id AS id0, p2.age_from, p2.age_to, p2.age_type, p2.count_on_package, p2.country, p2.dificit, p2.dosage, p2.is_required, p2.link_product, p2.manufacturer, p2.name, p2.packaging_unit, p2.path_image, p2.price_with_markup, p2.price_without_markup, p2.release_form, p2.state, p2.type, p2.type_of_packaging\r\n    FROM product_histories AS p1\r\n    LEFT JOIN products AS p2 ON p1.product_id = p2.id\r\n) AS t ON p.id = t.pharmacy_order_id\r\nWHERE p.order_id = @__orderId_0\r\nORDER BY p.id, p0.id, t.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c9123465-ec48-4e77-acaa-57bd55706419","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetPharmacyOrders (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000012","RequestPath":"/api/orders/pharmacy-orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.7400772Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p0.geolocation_link не существует\r\n\r\nPOSITION: 84\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p0.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p0.gelolocation_link\".\r\n    Position: 84\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p0.geolocation_link не существует\r\n\r\nPOSITION: 84\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p0.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p0.gelolocation_link\".\r\n    Position: 84\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"c9123465-ec48-4e77-acaa-57bd55706419","ActionName":"YallaPharm.API.Controllers.OrderApiController.GetPharmacyOrders (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000012","RequestPath":"/api/orders/pharmacy-orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.7515704Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["87.9430"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p0.geolocation_link не существует\r\n\r\nPOSITION: 84\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetPharmacyOrdersAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 465\r\n   at YallaPharm.API.Controllers.OrderApiController.GetPharmacyOrders(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 171\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p0.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p0.gelolocation_link\".\r\n    Position: 84\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/orders/pharmacy-orders/test-order-id","StatusCode":500,"Elapsed":87.943,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000012","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.7671243Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p0.geolocation_link не существует\r\n\r\nPOSITION: 84\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.GetPharmacyOrdersAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 465\r\n   at YallaPharm.API.Controllers.OrderApiController.GetPharmacyOrders(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 171\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p0.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p0.gelolocation_link\".\r\n    Position: 84\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/orders/pharmacy-orders/test-order-id","TraceId":"0HNJ4KS78KGN1:00000012","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000012","RequestPath":"/api/orders/pharmacy-orders/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.9348283Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"035c2e80-ebd0-4337-851d-e4b68fd092d2","ActionName":"YallaPharm.API.Controllers.OrderApiController.UpdateState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000013","RequestPath":"/api/orders/update-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.9396759Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"035c2e80-ebd0-4337-851d-e4b68fd092d2","ActionName":"YallaPharm.API.Controllers.OrderApiController.UpdateState (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000013","RequestPath":"/api/orders/update-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.9472377Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["105.0816"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.API.Controllers.OrderApiController.UpdateState(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 33\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/update-state","StatusCode":500,"Elapsed":105.0816,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000013","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:10.9562731Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.API.Controllers.OrderApiController.UpdateState(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 33\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/update-state","TraceId":"0HNJ4KS78KGN1:00000013","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000013","RequestPath":"/api/orders/update-state","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:11.8412316Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"24","parameters":"@p0='e41ce80a-8c4e-4f7d-a880-f37810648b48' (Nullable = false), @p1=NULL (DbType = Decimal), @p2=NULL (DbType = Decimal), @p3=NULL (DbType = Decimal), @p4=NULL (DbType = Decimal), @p5=NULL (DbType = Decimal), @p6='' (Nullable = false), @p7='test-id' (Nullable = false), @p8=NULL, @p9=NULL, @p10=NULL, @p11=NULL, @p12=NULL, @p13=NULL, @p14=NULL, @p15=NULL (DbType = Decimal), @p16='' (Nullable = false), @p17='ORD-20260205-A17ED7BA' (Nullable = false), @p18=NULL (DbType = Decimal), @p19=NULL (DbType = Decimal), @p20=NULL (DbType = Decimal), @p21=NULL (DbType = Decimal), @p22='0', @p23=NULL (DbType = Decimal), @p24=NULL, @p25='3756a4ac-8b4f-4f75-a4a2-1f9c8e925fb6' (Nullable = false), @p26=NULL (DbType = Int32), @p27=NULL (DbType = Int32), @p28=NULL (DbType = Int32), @p29=NULL, @p30=NULL (DbType = DateTime), @p31=NULL, @p32=NULL (DbType = DateTime), @p33='2026-02-05T11:12:11.1001699Z' (Nullable = true) (DbType = DateTime), @p34=NULL (DbType = DateTime), @p35=NULL (DbType = DateTime), @p36='2026-02-05T11:12:11.1001094Z' (Nullable = true) (DbType = DateTime), @p37=NULL (DbType = DateTime), @p38=NULL (DbType = DateTime), @p39=NULL (DbType = DateTime), @p40='2026-02-05T11:12:11.1002241Z' (Nullable = true) (DbType = DateTime), @p41=NULL, @p42=NULL, @p43=NULL (DbType = Int32), @p44=NULL (DbType = Int32), @p45=NULL (DbType = DateTime), @p46=NULL (DbType = DateTime), @p47='e41ce80a-8c4e-4f7d-a880-f37810648b48' (Nullable = false), @p48=NULL (DbType = DateTime), @p49=NULL, @p50=NULL, @p51=NULL, @p52=NULL (DbType = DateTime), @p53=NULL (DbType = DateTime), @p54=NULL (DbType = Int32), @p55=NULL (DbType = DateTime), @p56=NULL, @p57=NULL, @p58=NULL, @p59=NULL, @p60=NULL (DbType = DateTime), @p61=NULL (DbType = DateTime), @p62=NULL (DbType = Int32), @p63=NULL (DbType = DateTime), @p64='Application', @p65=NULL (DbType = DateTime), @p66=NULL (DbType = DateTime), @p67=NULL (DbType = DateTime), @p68=NULL (DbType = DateTime), @p69=NULL (DbType = DateTime)","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"INSERT INTO orders (id, amount_with_delivery, amount_with_discount, amount_with_markup, amount_without_delivery, amount_without_markup, city_or_district, client_id, comes_from, comment, comment_for_courier, country_to_delivery, courier, delivered_at, delivery_type, discount, operator, order_number, prepayment, price_for_delivery_outside_the_city, remaining_payment, rest_payment, total_cost, total_order_amount_excluding_delivery, type)\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24);\r\nINSERT INTO order_histories (id, amount_of_delivery_time, amount_of_processing_time, amount_of_time_respond_client, calling_at, canceled_at, comment_for_courier, confirmed_at, consulted_at, courier_accepted_at, courier_received_at, created_at, delivered_at, delivered_time, individual_delivery_time, lead_created_at, long_search_reason, message, minutes_for_entire_process_finish, minutes_for_entire_process_to_placement, notified_at, order_date, order_id, order_processing_time, past_state, payment_method, payment_status, placed_at, placement_at, previous_state_before_rejection_state, ready_for_shipment_at, reason_for_order_cancellation, reason_for_order_delay, reason_for_order_rejection, reason_for_returning_the_order, request_date, request_processing_time, returned_products_count, searching_at, state, time_for_accepting_request, time_inform_customer_about_product, time_of_completion_of_inquiry, time_to_obtain_client_approval, time_to_send_check_to_client)\r\nVALUES (@p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, @p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69)\r\nRETURNING is_returned, was_rejection;","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"708f0c5d-76aa-4d26-a80f-8b3145f2179c","ActionName":"YallaPharm.API.Controllers.OrderApiController.CreateConsulting (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000014","RequestPath":"/api/orders/consulting","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:11.8846637Z","@mt":"An exception occurred in the database while saving changes for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.\r\n ---> Npgsql.PostgresException (0x80004005): 23502: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n\r\nDETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 23502\r\n    MessageText: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n    SchemaName: public\r\n    TableName: orders\r\n    ColumnName: prepayment\r\n    File: execMain.c\r\n    Line: 1993\r\n    Routine: ExecConstraints\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.\r\n ---> Npgsql.PostgresException (0x80004005): 23502: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n\r\nDETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 23502\r\n    MessageText: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n    SchemaName: public\r\n    TableName: orders\r\n    ColumnName: prepayment\r\n    File: execMain.c\r\n    Line: 1993\r\n    Routine: ExecConstraints\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)","EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"708f0c5d-76aa-4d26-a80f-8b3145f2179c","ActionName":"YallaPharm.API.Controllers.OrderApiController.CreateConsulting (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000014","RequestPath":"/api/orders/consulting","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:11.8941718Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["866.7612"],"@l":"Error","@x":"Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.\r\n ---> Npgsql.PostgresException (0x80004005): 23502: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n\r\nDETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 23502\r\n    MessageText: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n    SchemaName: public\r\n    TableName: orders\r\n    ColumnName: prepayment\r\n    File: execMain.c\r\n    Line: 1993\r\n    Routine: ExecConstraints\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.CreateConsultingAsync(OrderDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 387\r\n   at YallaPharm.API.Controllers.OrderApiController.CreateConsulting(OrderDto orderDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 79\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/consulting","StatusCode":500,"Elapsed":866.7612,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000014","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:11.9237555Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.\r\n ---> Npgsql.PostgresException (0x80004005): 23502: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n\r\nDETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 23502\r\n    MessageText: значение NULL в столбце \"prepayment\" отношения \"orders\" нарушает ограничение NOT NULL\r\n    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.\r\n    SchemaName: public\r\n    TableName: orders\r\n    ColumnName: prepayment\r\n    File: execMain.c\r\n    Line: 1993\r\n    Routine: ExecConstraints\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.CreateConsultingAsync(OrderDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 387\r\n   at YallaPharm.API.Controllers.OrderApiController.CreateConsulting(OrderDto orderDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 79\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48","Method":"POST","Path":"/api/orders/consulting","TraceId":"0HNJ4KS78KGN1:00000014","StatusCode":500,"ExceptionType":"DbUpdateException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000014","RequestPath":"/api/orders/consulting","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.1611836Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"54","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"9302a829-831e-4b41-98c7-88837858a081","ActionName":"YallaPharm.API.Controllers.OrderApiController.InSearch (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000015","RequestPath":"/api/orders/insearch/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.1675710Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"9302a829-831e-4b41-98c7-88837858a081","ActionName":"YallaPharm.API.Controllers.OrderApiController.InSearch (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000015","RequestPath":"/api/orders/insearch/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.1840807Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["97.5261"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.InSearchAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 399\r\n   at YallaPharm.API.Controllers.OrderApiController.InSearch(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 91\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/insearch/test-order-id","StatusCode":500,"Elapsed":97.5261,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000015","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.2157963Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.InSearchAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 399\r\n   at YallaPharm.API.Controllers.OrderApiController.InSearch(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 91\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/insearch/test-order-id","TraceId":"0HNJ4KS78KGN1:00000015","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000015","RequestPath":"/api/orders/insearch/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.3017903Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"34b7dcd9-e21e-4f61-a0d3-87f55e7e1bb4","ActionName":"YallaPharm.API.Controllers.OrderApiController.WaitingClient (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000016","RequestPath":"/api/orders/waiting-client/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.3079099Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"34b7dcd9-e21e-4f61-a0d3-87f55e7e1bb4","ActionName":"YallaPharm.API.Controllers.OrderApiController.WaitingClient (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000016","RequestPath":"/api/orders/waiting-client/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.3188998Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["37.4157"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.WaitingClientAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 404\r\n   at YallaPharm.API.Controllers.OrderApiController.WaitingClient(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 101\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/waiting-client/test-order-id","StatusCode":500,"Elapsed":37.4157,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000016","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.3340266Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.WaitingClientAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 404\r\n   at YallaPharm.API.Controllers.OrderApiController.WaitingClient(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 101\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/waiting-client/test-order-id","TraceId":"0HNJ4KS78KGN1:00000016","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000016","RequestPath":"/api/orders/waiting-client/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.4408599Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"0d943c3f-6f38-40da-8e9f-eb36063e2bb6","ActionName":"YallaPharm.API.Controllers.OrderApiController.Placement (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000017","RequestPath":"/api/orders/placement/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.4459077Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"0d943c3f-6f38-40da-8e9f-eb36063e2bb6","ActionName":"YallaPharm.API.Controllers.OrderApiController.Placement (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000017","RequestPath":"/api/orders/placement/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.4580402Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["35.8633"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.PlacementAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 409\r\n   at YallaPharm.API.Controllers.OrderApiController.Placement(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 111\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/placement/test-order-id","StatusCode":500,"Elapsed":35.8633,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000017","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.4719289Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.PlacementAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 409\r\n   at YallaPharm.API.Controllers.OrderApiController.Placement(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 111\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/placement/test-order-id","TraceId":"0HNJ4KS78KGN1:00000017","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000017","RequestPath":"/api/orders/placement/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.5535143Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"8d9be70b-461d-471e-8163-af4d1c5654db","ActionName":"YallaPharm.API.Controllers.OrderApiController.Delivered (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000018","RequestPath":"/api/orders/delivered/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.5568816Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"8d9be70b-461d-471e-8163-af4d1c5654db","ActionName":"YallaPharm.API.Controllers.OrderApiController.Delivered (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000018","RequestPath":"/api/orders/delivered/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.5667218Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["28.9503"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.DeliveredAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 414\r\n   at YallaPharm.API.Controllers.OrderApiController.Delivered(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 121\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/delivered/test-order-id","StatusCode":500,"Elapsed":28.9503,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000018","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.6234004Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.DeliveredAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 414\r\n   at YallaPharm.API.Controllers.OrderApiController.Delivered(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 121\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/delivered/test-order-id","TraceId":"0HNJ4KS78KGN1:00000018","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000018","RequestPath":"/api/orders/delivered/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.7081726Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"dcca5159-de58-4e64-a20a-567177acccb9","ActionName":"YallaPharm.API.Controllers.OrderApiController.Cancellation (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000019","RequestPath":"/api/orders/cancellation/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.7114403Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"dcca5159-de58-4e64-a20a-567177acccb9","ActionName":"YallaPharm.API.Controllers.OrderApiController.Cancellation (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000019","RequestPath":"/api/orders/cancellation/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.7236555Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["34.4765"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.CancellationAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 419\r\n   at YallaPharm.API.Controllers.OrderApiController.Cancellation(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 131\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/cancellation/test-order-id","StatusCode":500,"Elapsed":34.4765,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000019","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.7382658Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.CancellationAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 419\r\n   at YallaPharm.API.Controllers.OrderApiController.Cancellation(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 131\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/cancellation/test-order-id","TraceId":"0HNJ4KS78KGN1:00000019","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000019","RequestPath":"/api/orders/cancellation/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.8319534Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"6845bcc7-3aa3-4455-90d0-ea6e118b4c5a","ActionName":"YallaPharm.API.Controllers.OrderApiController.Rejection (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001A","RequestPath":"/api/orders/rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.8364385Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"6845bcc7-3aa3-4455-90d0-ea6e118b4c5a","ActionName":"YallaPharm.API.Controllers.OrderApiController.Rejection (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001A","RequestPath":"/api/orders/rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.8445478Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27.4501"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.RejectionAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 424\r\n   at YallaPharm.API.Controllers.OrderApiController.Rejection(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 141\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/rejection/test-order-id","StatusCode":500,"Elapsed":27.4501,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001A","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:12.8563970Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.RejectionAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 424\r\n   at YallaPharm.API.Controllers.OrderApiController.Rejection(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 141\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/rejection/test-order-id","TraceId":"0HNJ4KS78KGN1:0000001A","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001A","RequestPath":"/api/orders/rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.0029205Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__orderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__orderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"fd0d5bb5-f76f-4f09-afb7-1b18043163f5","ActionName":"YallaPharm.API.Controllers.OrderApiController.ReturnFromRejection (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001B","RequestPath":"/api/orders/return-from-rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.0075425Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"fd0d5bb5-f76f-4f09-afb7-1b18043163f5","ActionName":"YallaPharm.API.Controllers.OrderApiController.ReturnFromRejection (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001B","RequestPath":"/api/orders/return-from-rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.0192653Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["90.0229"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.ReturnFromRejectionAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 432\r\n   at YallaPharm.API.Controllers.OrderApiController.ReturnFromRejection(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 151\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/return-from-rejection/test-order-id","StatusCode":500,"Elapsed":90.0229,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001B","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.0362925Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.ReturnFromRejectionAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 432\r\n   at YallaPharm.API.Controllers.OrderApiController.ReturnFromRejection(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 151\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/return-from-rejection/test-order-id","TraceId":"0HNJ4KS78KGN1:0000001B","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001B","RequestPath":"/api/orders/return-from-rejection/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.1257180Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__dto_OrderId_0='test-order-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT o.id, o.amount_with_delivery, o.amount_with_discount, o.amount_with_markup, o.amount_without_delivery, o.amount_without_markup, o.city_or_district, o.client_id, o.comes_from, o.comment, o.comment_for_courier, o.country_to_delivery, o.courier, o.delivered_at, o.delivery_type, o.discount, o.operator, o.order_number, o.prepayment, o.price_for_delivery_outside_the_city, o.remaining_payment, o.rest_payment, o.total_cost, o.total_order_amount_excluding_delivery, o.type, o0.id, o0.amount_of_delivery_time, o0.amount_of_processing_time, o0.amount_of_time_respond_client, o0.calling_at, o0.canceled_at, o0.comment_for_courier, o0.confirmed_at, o0.consulted_at, o0.courier_accepted_at, o0.courier_received_at, o0.created_at, o0.delivered_at, o0.delivered_time, o0.individual_delivery_time, o0.is_returned, o0.lead_created_at, o0.long_search_reason, o0.message, o0.minutes_for_entire_process_finish, o0.minutes_for_entire_process_to_placement, o0.notified_at, o0.order_date, o0.order_id, o0.order_processing_time, o0.past_state, o0.payment_method, o0.payment_status, o0.placed_at, o0.placement_at, o0.previous_state_before_rejection_state, o0.ready_for_shipment_at, o0.reason_for_order_cancellation, o0.reason_for_order_delay, o0.reason_for_order_rejection, o0.reason_for_returning_the_order, o0.request_date, o0.request_processing_time, o0.returned_products_count, o0.searching_at, o0.state, o0.time_for_accepting_request, o0.time_inform_customer_about_product, o0.time_of_completion_of_inquiry, o0.time_to_obtain_client_approval, o0.time_to_send_check_to_client, o0.was_rejection\r\nFROM orders AS o\r\nLEFT JOIN order_histories AS o0 ON o.id = o0.order_id\r\nWHERE o.id = @__dto_OrderId_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"25c1c081-60cf-46d9-848d-f8dbb783d26a","ActionName":"YallaPharm.API.Controllers.OrderApiController.ReturnProducts (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001C","RequestPath":"/api/orders/return-products/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.1287255Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"25c1c081-60cf-46d9-848d-f8dbb783d26a","ActionName":"YallaPharm.API.Controllers.OrderApiController.ReturnProducts (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001C","RequestPath":"/api/orders/return-products/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.1361164Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["27.0982"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.ReturnProductsAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 457\r\n   at YallaPharm.API.Controllers.OrderApiController.ReturnProducts(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 161\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/orders/return-products/test-order-id","StatusCode":500,"Elapsed":27.0982,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001C","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.1470878Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец o0.delivered_time не существует\r\n\r\nPOSITION: 745\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.OrderService.UpdateStateAsync(UpdateOrderStateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 80\r\n   at YallaPharm.Application.Services.OrderService.ReturnProductsAsync(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\OrderService.cs:line 457\r\n   at YallaPharm.API.Controllers.OrderApiController.ReturnProducts(String orderId) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\OrderApiController.cs:line 161\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец o0.delivered_time не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"o0.delivery_time\".\r\n    Position: 745\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/orders/return-products/test-order-id","TraceId":"0HNJ4KS78KGN1:0000001C","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001C","RequestPath":"/api/orders/return-products/test-order-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.2828562Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.address, p.contact, p.country, p.geolocation_link, p.is_abroad, p.is_required, p.landmark, p.markup, p.markup_type, p.name, p.payout_method, p0.id, p0.contact, p0.contact_type, p0.pharmacy_id\r\nFROM pharmacies AS p\r\nLEFT JOIN pharmacy_contacts AS p0 ON p.id = p0.pharmacy_id\r\nORDER BY p.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"5e364333-1ac0-48e8-947a-af32b9f20323","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001D","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.2875777Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"5e364333-1ac0-48e8-947a-af32b9f20323","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001D","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.2958116Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["73.6673"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 118\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/pharmacy","StatusCode":500,"Elapsed":73.6673,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001D","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.3076884Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 118\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/pharmacy","TraceId":"0HNJ4KS78KGN1:0000001D","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001D","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.4270261Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"@__id_0='test-pharmacy-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.address, t.contact, t.country, t.geolocation_link, t.is_abroad, t.is_required, t.landmark, t.markup, t.markup_type, t.name, t.payout_method, p0.id, p0.contact, p0.contact_type, p0.pharmacy_id\r\nFROM (\r\n    SELECT p.id, p.address, p.contact, p.country, p.geolocation_link, p.is_abroad, p.is_required, p.landmark, p.markup, p.markup_type, p.name, p.payout_method\r\n    FROM pharmacies AS p\r\n    WHERE p.id = @__id_0\r\n    LIMIT 1\r\n) AS t\r\nLEFT JOIN pharmacy_contacts AS p0 ON t.id = p0.pharmacy_id\r\nORDER BY t.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"ecae6342-3b40-4119-9790-b96b8285c47b","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001E","RequestPath":"/api/pharmacy/test-pharmacy-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.4321387Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"ecae6342-3b40-4119-9790-b96b8285c47b","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001E","RequestPath":"/api/pharmacy/test-pharmacy-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.4394721Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["57.6360"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 109\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 51\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/pharmacy/test-pharmacy-id","StatusCode":500,"Elapsed":57.636,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001E","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.4543684Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 109\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 51\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/pharmacy/test-pharmacy-id","TraceId":"0HNJ4KS78KGN1:0000001E","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001E","RequestPath":"/api/pharmacy/test-pharmacy-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.5761867Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"1","parameters":"@__dto_Id_0='test-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT t.id, t.address, t.contact, t.country, t.geolocation_link, t.is_abroad, t.is_required, t.landmark, t.markup, t.markup_type, t.name, t.payout_method, p0.id, p0.contact, p0.contact_type, p0.pharmacy_id\r\nFROM (\r\n    SELECT p.id, p.address, p.contact, p.country, p.geolocation_link, p.is_abroad, p.is_required, p.landmark, p.markup, p.markup_type, p.name, p.payout_method\r\n    FROM pharmacies AS p\r\n    WHERE p.id = @__dto_Id_0\r\n    LIMIT 1\r\n) AS t\r\nLEFT JOIN pharmacy_contacts AS p0 ON t.id = p0.pharmacy_id\r\nORDER BY t.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"eb761fab-d3a2-4037-992b-e6efe2769fae","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001F","RequestPath":"/api/pharmacy/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.5801620Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"eb761fab-d3a2-4037-992b-e6efe2769fae","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:0000001F","RequestPath":"/api/pharmacy/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.5855650Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["50.3059"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.UpdateAsync(PharmacyDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 58\r\n   at YallaPharm.API.Controllers.PharmacyApiController.Update(PharmacyDto pharmacyDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 32\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/pharmacy/update","StatusCode":500,"Elapsed":50.3059,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000001F","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.5947167Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 267\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.UpdateAsync(PharmacyDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 58\r\n   at YallaPharm.API.Controllers.PharmacyApiController.Update(PharmacyDto pharmacyDto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 32\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 267\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/pharmacy/update","TraceId":"0HNJ4KS78KGN1:0000001F","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:0000001F","RequestPath":"/api/pharmacy/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.7407583Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"System.InvalidOperationException: An error occurred while reading a database value for property 'Product.AgeFrom'. The expected type was 'System.Nullable`1[System.Int32]' but the actual value was of type 'System.String'.\r\n ---> System.InvalidCastException: Can't cast database type character varying to Int32\r\n   at Npgsql.Internal.TypeHandling.NpgsqlTypeHandler.ReadCustom[TAny](NpgsqlReadBuffer buf, Int32 len, Boolean async, FieldDescription fieldDescription)\r\n   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)\r\n   at Npgsql.NpgsqlDataReader.GetInt32(Int32 ordinal)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"System.InvalidOperationException: An error occurred while reading a database value for property 'Product.AgeFrom'. The expected type was 'System.Nullable`1[System.Int32]' but the actual value was of type 'System.String'.\r\n ---> System.InvalidCastException: Can't cast database type character varying to Int32\r\n   at Npgsql.Internal.TypeHandling.NpgsqlTypeHandler.ReadCustom[TAny](NpgsqlReadBuffer buf, Int32 len, Boolean async, FieldDescription fieldDescription)\r\n   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)\r\n   at Npgsql.NpgsqlDataReader.GetInt32(Int32 ordinal)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"3cb328d3-a257-43b4-97a7-fc8cddeb49b7","ActionName":"YallaPharm.API.Controllers.ProductApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000020","RequestPath":"/api/product","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.7433145Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["75.7447"],"@l":"Error","@x":"System.InvalidOperationException: An error occurred while reading a database value for property 'Product.AgeFrom'. The expected type was 'System.Nullable`1[System.Int32]' but the actual value was of type 'System.String'.\r\n ---> System.InvalidCastException: Can't cast database type character varying to Int32\r\n   at Npgsql.Internal.TypeHandling.NpgsqlTypeHandler.ReadCustom[TAny](NpgsqlReadBuffer buf, Int32 len, Boolean async, FieldDescription fieldDescription)\r\n   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)\r\n   at Npgsql.NpgsqlDataReader.GetInt32(Int32 ordinal)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.InitializeAsync(DbDataReader reader, IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.InitializeAsync(IReadOnlyList`1 columns, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductService.cs:line 99\r\n   at YallaPharm.API.Controllers.ProductApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/product","StatusCode":500,"Elapsed":75.7447,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000020","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.7487464Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType} - Message: {Message}","@l":"Warning","Method":"GET","Path":"/api/product","TraceId":"0HNJ4KS78KGN1:00000020","StatusCode":400,"ExceptionType":"InvalidOperationException","Message":"An error occurred while reading a database value for property 'Product.AgeFrom'. The expected type was 'System.Nullable`1[System.Int32]' but the actual value was of type 'System.String'.","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000020","RequestPath":"/api/product","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.8466560Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["33.1060"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/product/test-product-id","StatusCode":404,"Elapsed":33.106,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000021","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:13.9305989Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["29.8134"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/product/update","StatusCode":404,"Elapsed":29.8134,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000022","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.0222800Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.active_ingredient, p.age_from, p.age_to, p.application_method_id, p.category_id, p.comment, p.contraindication_for_use, p.dosage, p.dosage_unit, p.dried_fruit, p.for_allergy_sufferers, p.for_children, p.for_diabetics, p.for_driver, p.for_pregnant_women, p.for_whom_id, p.indication_for_use, p.instructions, p.minimum_quantity_per_piece, p.name, p.nickname, p.organs_and_systems_id, p.pack_quantity_or_drug_volume, p.packaging_material_id, p.packaging_unit, p.preparation_color_id, p.preparation_material_id, p.preparation_taste, p.scope_of_application_id, p.season_of_application, p.symptom, p.time_of_application_id, p.vacation_condition, p.with_caution\r\nFROM product_templates AS p","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"3d2bd96f-31ea-46e5-8aef-d62f6f11ce67","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000023","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.0253690Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"3d2bd96f-31ea-46e5-8aef-d62f6f11ce67","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000023","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.0312509Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["47.7033"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 216\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/productTemplate","StatusCode":500,"Elapsed":47.7033,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000023","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.0402292Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 216\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/productTemplate","TraceId":"0HNJ4KS78KGN1:00000023","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000023","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.1815482Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"3","parameters":"@__p_0='test-template-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.active_ingredient, p.age_from, p.age_to, p.application_method_id, p.category_id, p.comment, p.contraindication_for_use, p.dosage, p.dosage_unit, p.dried_fruit, p.for_allergy_sufferers, p.for_children, p.for_diabetics, p.for_driver, p.for_pregnant_women, p.for_whom_id, p.indication_for_use, p.instructions, p.minimum_quantity_per_piece, p.name, p.nickname, p.organs_and_systems_id, p.pack_quantity_or_drug_volume, p.packaging_material_id, p.packaging_unit, p.preparation_color_id, p.preparation_material_id, p.preparation_taste, p.scope_of_application_id, p.season_of_application, p.symptom, p.time_of_application_id, p.vacation_condition, p.with_caution\r\nFROM product_templates AS p\r\nWHERE p.id = @__p_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"94db95f7-b44c-4ecc-8820-e7f4a9f61553","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000024","RequestPath":"/api/productTemplate/test-template-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.1877000Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"94db95f7-b44c-4ecc-8820-e7f4a9f61553","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetById (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000024","RequestPath":"/api/productTemplate/test-template-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.2010347Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["84.0016"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 207\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 58\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/productTemplate/test-template-id","StatusCode":500,"Elapsed":84.0016,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000024","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.2273573Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetByIdAsync(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 207\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetById(String id) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 58\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/productTemplate/test-template-id","TraceId":"0HNJ4KS78KGN1:00000024","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000024","RequestPath":"/api/productTemplate/test-template-id","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.4344720Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"5","parameters":"@__p_0='test-id'","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.active_ingredient, p.age_from, p.age_to, p.application_method_id, p.category_id, p.comment, p.contraindication_for_use, p.dosage, p.dosage_unit, p.dried_fruit, p.for_allergy_sufferers, p.for_children, p.for_diabetics, p.for_driver, p.for_pregnant_women, p.for_whom_id, p.indication_for_use, p.instructions, p.minimum_quantity_per_piece, p.name, p.nickname, p.organs_and_systems_id, p.pack_quantity_or_drug_volume, p.packaging_material_id, p.packaging_unit, p.preparation_color_id, p.preparation_material_id, p.preparation_taste, p.scope_of_application_id, p.season_of_application, p.symptom, p.time_of_application_id, p.vacation_condition, p.with_caution\r\nFROM product_templates AS p\r\nWHERE p.id = @__p_0\r\nLIMIT 1","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"f848f12c-145d-4269-b9b8-5c3e338917d6","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000025","RequestPath":"/api/productTemplate/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.4402512Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"f848f12c-145d-4269-b9b8-5c3e338917d6","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000025","RequestPath":"/api/productTemplate/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.4714709Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["93.1827"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.UpdateAsync(ProductTemplateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 131\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.Update(ProductTemplateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 39\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/productTemplate/update","StatusCode":500,"Elapsed":93.1827,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000025","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.4938710Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.UpdateAsync(ProductTemplateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 131\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.Update(ProductTemplateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 39\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","Method":"POST","Path":"/api/productTemplate/update","TraceId":"0HNJ4KS78KGN1:00000025","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000025","RequestPath":"/api/productTemplate/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.6310080Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["49.9163"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/packagingType","StatusCode":200,"Elapsed":49.9163,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000026","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.7240919Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["25.5840"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/packagingType/test-id","StatusCode":404,"Elapsed":25.584,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000027","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.8076448Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["19.9789"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/packagingType/update","StatusCode":404,"Elapsed":19.9789,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000028","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:14.9156064Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["47.7797"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/packagingUnit","StatusCode":200,"Elapsed":47.7797,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000029","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.0213494Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["36.8932"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/packagingUnit/test-id","StatusCode":404,"Elapsed":36.8932,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002A","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.1064918Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["24.0562"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/packagingUnit/update","StatusCode":404,"Elapsed":24.0562,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002B","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.1989239Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["33.8259"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/paymentMethod","StatusCode":200,"Elapsed":33.8259,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002C","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.2737921Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["20.8572"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/paymentMethod/test-id","StatusCode":404,"Elapsed":20.8572,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002D","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.3459647Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["15.0091"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/paymentMethod/update","StatusCode":404,"Elapsed":15.0091,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002E","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.4555910Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["51.0907"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/releaseForm","StatusCode":200,"Elapsed":51.0907,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:0000002F","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.5397236Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["26.8708"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/api/releaseForm/test-id","StatusCode":404,"Elapsed":26.8708,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000030","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.6245244Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["24.2738"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/releaseForm/update","StatusCode":404,"Elapsed":24.2738,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000031","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7060213Z","@mt":"SendAsync called with empty CourierId for order {OrderId}","@l":"Warning","OrderId":"test-id","SourceContext":"YallaPharm.Application.Services.DeliveryService","ActionId":"f2c8b432-00ca-4d62-9779-2ac22308a3e1","ActionName":"YallaPharm.API.Controllers.DeliveryController.Send (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000032","RequestPath":"/api/delivery/send","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7075615Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["16.7539"],"@l":"Error","@x":"YallaPharm.Application.Exceptions.ValidationException: CourierId is required\r\n   at YallaPharm.Application.Services.DeliveryService.SendAsync(DeliverySendDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\DeliveryService.cs:line 67\r\n   at YallaPharm.API.Controllers.DeliveryController.Send(DeliverySendDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\DeliveryController.cs:line 23\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/delivery/send","StatusCode":500,"Elapsed":16.7539,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000032","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7098415Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType} - Message: {Message}","@l":"Warning","Method":"POST","Path":"/api/delivery/send","TraceId":"0HNJ4KS78KGN1:00000032","StatusCode":400,"ExceptionType":"ValidationException","Message":"CourierId is required","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000032","RequestPath":"/api/delivery/send","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7816259Z","@mt":"UpdateAsync called with empty Status for order {OrderId}","@l":"Warning","OrderId":"test-id","SourceContext":"YallaPharm.Application.Services.DeliveryService","ActionId":"3e86260b-4539-413d-933f-8cfc0f3cf4a7","ActionName":"YallaPharm.API.Controllers.DeliveryController.Update (YallaPharm.API)","RequestId":"0HNJ4KS78KGN1:00000033","RequestPath":"/api/delivery/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7830706Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["16.6608"],"@l":"Error","@x":"YallaPharm.Application.Exceptions.ValidationException: Status is required\r\n   at YallaPharm.Application.Services.DeliveryService.UpdateAsync(DeliveryUpdateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\DeliveryService.cs:line 110\r\n   at YallaPharm.API.Controllers.DeliveryController.Update(DeliveryUpdateDto dto) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\DeliveryController.cs:line 33\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)","RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/api/delivery/update","StatusCode":500,"Elapsed":16.6608,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000033","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.7865905Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType} - Message: {Message}","@l":"Warning","Method":"POST","Path":"/api/delivery/update","TraceId":"0HNJ4KS78KGN1:00000033","StatusCode":400,"ExceptionType":"ValidationException","Message":"Status is required","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN1:00000033","RequestPath":"/api/delivery/update","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.8618098Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["15.2675"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"GET","RequestPath":"/telegram","StatusCode":200,"Elapsed":15.2675,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000034","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:12:15.9325129Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["14.8663"],"RequestHost":"localhost:5071","UserAgent":"","RequestMethod":"POST","RequestPath":"/telegram","StatusCode":200,"Elapsed":14.8663,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN1:00000035","ConnectionId":"0HNJ4KS78KGN1"}
{"@t":"2026-02-05T11:22:46.3530299Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["3.3650"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":400,"Elapsed":3.365,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN3:00000001","ConnectionId":"0HNJ4KS78KGN3"}
{"@t":"2026-02-05T11:22:55.5838632Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["1.0894"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":400,"Elapsed":1.0894,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN4:00000001","ConnectionId":"0HNJ4KS78KGN4"}
{"@t":"2026-02-05T11:23:22.9476008Z","@mt":"User {Email} logged in successfully","Email":"admin@yallapharm.com","SourceContext":"YallaPharm.Application.Services.AuthService","ActionId":"3bbf6e63-6d28-4f2e-b684-9d6133b6e26d","ActionName":"YallaPharm.API.Controllers.LoginController.Login (YallaPharm.API)","RequestId":"0HNJ4KS78KGN5:00000001","RequestPath":"/api/login","ConnectionId":"0HNJ4KS78KGN5"}
{"@t":"2026-02-05T11:23:22.9490761Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["239.6538"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"POST","RequestPath":"/api/login","StatusCode":200,"Elapsed":239.6538,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN5:00000001","ConnectionId":"0HNJ4KS78KGN5"}
{"@t":"2026-02-05T11:23:38.7952216Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"8","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT c.id, c.age, c.childrens_age, c.contact_type, c.discount_for_client, c.economic_standing, c.family_status, c.full_name, c.gender, c.geolocation_of_client_address, c.having_children, c.having_elderly, c.landmark, c.language, c.phone_number, c.social_username, c.street, c.take_into_account, c.type, a.id, a.city, a.client_id, a.geolocation_of_client_address, a.landmark, a.street, c0.id, c0.age, c0.client_id, c0.full_name, c0.gender, c1.id, c1.age, c1.client_id, c1.full_name, c1.gender\r\nFROM clients AS c\r\nLEFT JOIN addresses AS a ON c.id = a.client_id\r\nLEFT JOIN client_childrens AS c0 ON c.id = c0.client_id\r\nLEFT JOIN client_adults AS c1 ON c.id = c1.client_id\r\nORDER BY c.id, a.id, c0.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c46cceb4-b06e-40aa-ad8a-2cb3f37a4b0e","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN6:00000001","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN6"}
{"@t":"2026-02-05T11:23:38.7998826Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"c46cceb4-b06e-40aa-ad8a-2cb3f37a4b0e","ActionName":"YallaPharm.API.Controllers.ClientApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN6:00000001","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN6"}
{"@t":"2026-02-05T11:23:38.8051761Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["23.3080"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 205\r\n   at YallaPharm.API.Controllers.ClientApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"GET","RequestPath":"/api/clients","StatusCode":500,"Elapsed":23.308,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN6:00000001","ConnectionId":"0HNJ4KS78KGN6"}
{"@t":"2026-02-05T11:23:38.8161541Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец a.client_id не существует\r\n\r\nPOSITION: 550\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ClientService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ClientService.cs:line 205\r\n   at YallaPharm.API.Controllers.ClientApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ClientApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец a.client_id не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"a.ClientId\".\r\n    Position: 550\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/clients","TraceId":"0HNJ4KS78KGN6:00000001","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN6:00000001","RequestPath":"/api/clients","ConnectionId":"0HNJ4KS78KGN6"}
{"@t":"2026-02-05T11:23:38.9224843Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"2","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.address, p.contact, p.country, p.geolocation_link, p.is_abroad, p.is_required, p.landmark, p.markup, p.markup_type, p.name, p.payout_method, p0.id, p0.contact, p0.contact_type, p0.pharmacy_id\r\nFROM pharmacies AS p\r\nLEFT JOIN pharmacy_contacts AS p0 ON p.id = p0.pharmacy_id\r\nORDER BY p.id","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"5e364333-1ac0-48e8-947a-af32b9f20323","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN7:00000001","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN7"}
{"@t":"2026-02-05T11:23:38.9249355Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"5e364333-1ac0-48e8-947a-af32b9f20323","ActionName":"YallaPharm.API.Controllers.PharmacyApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN7:00000001","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN7"}
{"@t":"2026-02-05T11:23:38.9297785Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["11.6930"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 118\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"GET","RequestPath":"/api/pharmacy","StatusCode":500,"Elapsed":11.693,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN7:00000001","ConnectionId":"0HNJ4KS78KGN7"}
{"@t":"2026-02-05T11:23:38.9382096Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.geolocation_link не существует\r\n\r\nPOSITION: 47\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.PharmacyService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\PharmacyService.cs:line 118\r\n   at YallaPharm.API.Controllers.PharmacyApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\PharmacyApiController.cs:line 61\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.geolocation_link не существует\r\n    Hint: Возможно, предполагалась ссылка на столбец \"p.gelolocation_link\".\r\n    Position: 47\r\n    File: parse_relation.c\r\n    Line: 3732\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/pharmacy","TraceId":"0HNJ4KS78KGN7:00000001","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN7:00000001","RequestPath":"/api/pharmacy","ConnectionId":"0HNJ4KS78KGN7"}
{"@t":"2026-02-05T11:23:39.0801416Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["4.4459"],"RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"GET","RequestPath":"/api/paymentMethod","StatusCode":200,"Elapsed":4.4459,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN8:00000001","ConnectionId":"0HNJ4KS78KGN8"}
{"@t":"2026-02-05T11:23:39.2024809Z","@mt":"Failed executing DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","@l":"Error","elapsed":"1","parameters":"","commandType":"Text","commandTimeout":60,"newLine":"\r\n","commandText":"SELECT p.id, p.active_ingredient, p.age_from, p.age_to, p.application_method_id, p.category_id, p.comment, p.contraindication_for_use, p.dosage, p.dosage_unit, p.dried_fruit, p.for_allergy_sufferers, p.for_children, p.for_diabetics, p.for_driver, p.for_pregnant_women, p.for_whom_id, p.indication_for_use, p.instructions, p.minimum_quantity_per_piece, p.name, p.nickname, p.organs_and_systems_id, p.pack_quantity_or_drug_volume, p.packaging_material_id, p.packaging_unit, p.preparation_color_id, p.preparation_material_id, p.preparation_taste, p.scope_of_application_id, p.season_of_application, p.symptom, p.time_of_application_id, p.vacation_condition, p.with_caution\r\nFROM product_templates AS p","EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"3d2bd96f-31ea-46e5-8aef-d62f6f11ce67","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN9:00000001","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN9"}
{"@t":"2026-02-05T11:23:39.2049382Z","@mt":"An exception occurred while iterating over the results of a query for context type '{contextType}'.{newline}{error}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","contextType":"YallaPharm.Infrastructure.Data.ApplicationDbContext","newline":"\r\n","error":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"3d2bd96f-31ea-46e5-8aef-d62f6f11ce67","ActionName":"YallaPharm.API.Controllers.ProductTemplateApiController.GetAll (YallaPharm.API)","RequestId":"0HNJ4KS78KGN9:00000001","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN9"}
{"@t":"2026-02-05T11:23:39.2115218Z","@mt":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","@r":["11.2170"],"@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 216\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","RequestHost":"localhost:5071","UserAgent":"curl/8.6.0","RequestMethod":"GET","RequestPath":"/api/productTemplate","StatusCode":500,"Elapsed":11.217,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ4KS78KGN9:00000001","ConnectionId":"0HNJ4KS78KGN9"}
{"@t":"2026-02-05T11:23:39.2176327Z","@mt":"HTTP {Method} {Path} - TraceId: {TraceId} - Status: {StatusCode} - Exception: {ExceptionType}","@l":"Error","@x":"Npgsql.PostgresException (0x80004005): 42703: столбец p.application_method_id не существует\r\n\r\nPOSITION: 57\r\n   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|234_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at YallaPharm.Application.Services.ProductTemplateService.GetAllAsync() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.Application\\Services\\ProductTemplateService.cs:line 216\r\n   at YallaPharm.API.Controllers.ProductTemplateApiController.GetAll() in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Controllers\\ProductTemplateApiController.cs:line 68\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)\r\n   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)\r\n   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)\r\n   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)\r\n   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)\r\n   at YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\\Users\\Mardin it\\Desktop\\yalla.pharm.crm\\src\\YallaPharm.API\\Middleware\\GlobalExceptionHandlerMiddleware.cs:line 48\r\n  Exception data:\r\n    Severity: ОШИБКА\r\n    SqlState: 42703\r\n    MessageText: столбец p.application_method_id не существует\r\n    Position: 57\r\n    File: parse_relation.c\r\n    Line: 3721\r\n    Routine: errorMissingColumn","Method":"GET","Path":"/api/productTemplate","TraceId":"0HNJ4KS78KGN9:00000001","StatusCode":500,"ExceptionType":"PostgresException","SourceContext":"YallaPharm.API.Middleware.GlobalExceptionHandlerMiddleware","RequestId":"0HNJ4KS78KGN9:00000001","RequestPath":"/api/productTemplate","ConnectionId":"0HNJ4KS78KGN9"}
